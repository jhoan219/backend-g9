"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vigilante=vigilante;var _jsonwebtoken=_interopRequireDefault(require("jsonwebtoken")),_usuarioModel=require("../models/usuarioModel.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function vigilante(r,t,n){var o,a,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Yo soy un middleware"),r.headers.authorization){e.next=3;break}return e.abrupt("return",t.status(401).json({message:"Se necesita una token para esta operacion"}));case 3:return o=r.headers.authorization.split(" ")[1],console.log(o),e.prev=5,a=_jsonwebtoken.default.verify(o,process.env.JWT_SECRET),console.log(a),e.next=10,regeneratorRuntime.awrap(_usuarioModel.Usuario.findById(a.jti));case 10:if(s=e.sent){e.next=13;break}throw new Error("Usuario no existe");case 13:r.user=s.toJSON(),n(),e.next=20;break;case 17:return e.prev=17,e.t0=e.catch(5),e.abrupt("return",t.status(400).json({message:" Token invalida",content:e.t0.message}));case 20:case"end":return e.stop()}},null,null,[[5,17]])}
//# sourceMappingURL=wachiman.min.js.map
