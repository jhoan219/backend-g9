"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.crearAgenda=crearAgenda,exports.listarAgenda=listarAgenda;var _agendaModel=require("../models/agendaModel.js"),_usuarioModel=require("../models/usuarioModel.js");function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(t,!0).forEach(function(e){_defineProperty(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(t).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function crearAgenda(r,t){var n,a,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.body,a=r.user._id,e.prev=2,e.next=5,regeneratorRuntime.awrap(_agendaModel.Agenda.create(_objectSpread({},n,{usuario:a})));case 5:return o=e.sent,e.next=8,regeneratorRuntime.awrap(_usuarioModel.Usuario.updateOne({_id:a},{agendas:[].concat(_toConsumableArray(r.user.agendas),[o._id])}));case 8:t.status(201).json({message:"Agenda creada exitosamente",content:o}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),t.status(400).json({message:"Error al crear la agenda",content:e.t0.message});case 14:case"end":return e.stop()}},null,null,[[2,11]])}function listarAgenda(r,t){var n,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.user._id,e.next=3,regeneratorRuntime.awrap(_agendaModel.Agenda.aggregate([{$match:{usuario:n}}]).lookup({from:"usuarios",localField:"usuario",foreignField:"_id",as:"propietario"}));case 3:a=e.sent,console.log(a),t.json({content:a});case 6:case"end":return e.stop()}})}
//# sourceMappingURL=agendaController.min.js.map
